{% extends "home/base.html" %} 
{% load staticfiles %} 
{% block addon_css %}
  <style>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

#ajaxresults22_paginate{
    margin: 50px 1px 50px 1px;

}

#ajaxresults22{
    table-layout: auto;
    border-collapse: collapse;
    width: 100%;
}

#ajaxresults22 td, ajaxresults22 tr{
    border-bottom: 15px solid transparent;
    border-top: 15px solid transparent;
    white-space: pre;
}

.paginate_button {
    background-color: #00e6e6;
    box-sizing: border-box;
    <!--display: inline-block;-->
    min-width: 1.5em;
    padding: 0.1px 15px;
    margin-left: 5px;
    text-align: center;
    text-decoration: none !important;
    cursor: pointer;
    *cursor: hand;
    color: #333 !important;
    border: 1px solid black;
    border-radius: 8px;

}

.paginate_button.current{
    background-color: #005ce6;
    box-sizing: border-box;
    <!--display: inline-block;-->
    min-width: 1.5em;
    padding: 0.1px 15px;
    margin-left: 5px;
    text-align: center;
    text-decoration: none !important;
    cursor: pointer;
    *cursor: hand;
    color: white !important;
    border: 1px solid black;
    border-radius: 8px;

}

.helpli{
    margin-left: 20px;
    font-size:22px;
}

.jumbotable td{
    padding: 1px 15px;

}
.paginate_button_disabled {
    background-color: #1a75ff;
    box-sizing: border-box;
    <!--display: inline-block;-->
    min-width: 1.5em;
    padding: 0.1px 15px;
    margin-left: 5px;
    text-align: center;
    text-decoration: none !important;
    cursor: pointer;
    *cursor: hand;
    color: #333 !important;
    border: 1px solid black;
    border-radius: 8px;
}
.paginate_button:hover {
    box-sizing: border-box;
    background-color: #3333cc;
    <!--display: inline-block;-->
    min-width: 1.5em;
    padding: 0.1px 15px;
    margin-left: 5px;
    text-align: center;
    text-decoration: none !important;
    cursor: pointer;
    *cursor: hand;
    color: #333 !important;
    border: 1px solid black;
    border-radius: 8px;

}
.paginate_active {
    background-color: white;
    box-sizing: border-box;
    <!--display: inline-block;-->
    min-width: 1.5em;
    padding: 0.1px 15px;
    margin-left: 5px;
    text-align: center;
    text-decoration: none !important;
    cursor: pointer;
    *cursor: hand;
    color: #333 !important;
    border: 1px solid black;
    border-radius: 8px;

}

#content{
    width:100%;
}

.panel-body {
    word-break:break-all;
}

#ajaxresults{
    padding: 20px;
}

#myTable{
    padding: 1px;
    width: 100%;
}


#myTable  th, #myTable  td {
    padding: 1px;
    text-align:left; 
    vertical-align:middle;
}


#haystacksearch{
    overflow-x: scroll;
}

#floatdiv {
    width:48%;
    overflow-y:auto;
    max-height:400px;
    overflow:auto;
    position: fixed;

}

#help{
    overflow-y:auto;
    max-height:300px;
    overflow:auto;
}

.foo{
    border: solid black 2px;
    padding: 1px;
    width: 20%
}

#hidden{
    width: 90%;
}

kbd{
    background-color:blue;
}
  </style>
{% endblock %}
{% block content %}
<div class="container-fluid">
 <div class="row">
  <div class="col-sm-12">
    <div id="headerbrowser" style="word-break: normal" class="jumbotron">
    <h1>Simulation browser</h1>
    <p>Use the panel in the left to search for the elements which form the simulation (GPCR's, other proteins, molecules and compounds). Click "Add to Search" button next to the results to join those elements in the right panel and find a system containing them.</p>
    <center><button  id="helpbutton" type="button" value="Help" class="btn btn-primary">Show Help</button></center>

      <div id="help" style="word-break: normal">

            <h2> Left Panel, searching the elements: </h2><br><br>
            <div style="padding:10px 40px">
            <li class="helpli">Search for compounds, molecules and proteins:</li><br>

            <p>Use the panel in the left to search for compounds, molecules or proteins. You can use SMILES, InChI, InChIKey and common names to search for molecules or compounds and Uniprot accession codes and common names to find proteins. You can filter the type of the results returned (All, Protein, Molecule, Compound, and other options that will be explained lately). Next to every result, you will find an "Add to search" button, which will add the element to the right panel, allowing you to search a system containing those elements. For example: Molecule Clozapine AND Protein P28222.</p>

            <li class="helpli" >Search by ID:</li><br>

            <p>You also have the option to search by the identifiers used in the GPCRmd database, just check the <b>"Search by GPCRmd ID" checkbox</b>. If you select this type of search, you can return Complexes, Complex Structures and Dynamics, as well as the other types. Below you will find the definition of these three concepts. You may find this kind of search useful to check if the simulation you have submited is available. </p>

            </div>
            <h2>Right Panel, joining the elements</h2><br>
            <div style="padding:10px 40px">
            <li class="helpli"> Simple and Advanced Search</li><br>

            <p>In the right panel, you can choose between <b>Simple and Advanced search</b>, the difference being that the second kind allows you to use "AND", "OR" and "NOT" boolean operators, as well as brackets. Simple search only allows "AND" operator (which is enough in most cases). The following is an example of how to perform a search with brackets:</p><br>

            <center><table class="jumbotable">
            <tr><td>P28222</td><td>P28222</td></tr>
            <tr><td>AND ( Serotonin</td><td>AND Serotonin</td></tr> 
            <tr><td>OR Clozapine</td><td> OR Clozapine</td></tr>
            <tr><td>OR POPC )</td><td>OR POPC</td></tr>
            </table></center>

            <p>The search in the left will return every system composed by any of the following options:</p>
            <ul>
            <li>P28222 + Serotonin</li>
            <li>P28222 + Clozapine</li>
            <li>P28222 + POPC </li>
            <li>P28222 + Serotonin + Clozapine</li>
            <li>P28222 + Serotonin + POPC </li>
            <li>P28222 + Serotonin + Clozapine+POPC </li>
            <li>P28222 + POPC + Clozapine </li>

            </ul>

            <p>However, the search in the right will return every system composed by any of the following options: </p>
            <ul>
            <li>P28222 + Serotonin</li>
            <li>Every system with Clozapine</li>
            <li>Every system with POPC </li>
            </ul>
    
            Please, keep in mind that if you look for P28222 AND Serotonin, the search will return every system composed by P28222, Serotonin, and maybe more componentes, as water, ions, etc.

            <br><li class="helpli"> Defining functions inside the system: </li><br>

            <p> You can select the function which the molecule performs in the system: "Orthosteric ligand", "Allosteric Ligand", "Other" or "All". "All" meaning any of the previous. For proteins, you can select if it is a GPCR or not, using the <b>"is GPCR" checkbox</b>. If it is not selected, we assume that the protein is NOT a GPCR.</p>

            <li class="helpli">Exact Match</li><br>

            <p> If you select "Exact Match" the search will return only those systems whose composition matches exactly the one you have build in this panel. If there is any other element in the system that you have not included in the search, it will not appear as a result. So if you search by P28222 AND Serotonin AND Water; a system composed by P28222, Serotonin, Water and Sodium will not appear as a result</p>

            <li class="helpli">Complex, Complex Structure and Dynamics</li><br>
            <p> You can also select between: <b>"Complex", "Complex Structure" or "Dynamics"</b>. "Complex" is a system composed by a GPCR and other proteins plus its orthoesteric and alloesteric ligands, "Complex Structure" is a complex with other selected co-crystallized molecules (think of it as a PDB file). Finally, "Dynamics" is a "Complex Structure" solvated and membrane-embeded with a trajectory. For the last two cases -"Complex Structure" and "Dynamics"- you can select what kind of system you want as results: <b>"complex" (the system is composed by proteins and ligands), "apoforms" (the system lacks ligands, but can have molecules with other functions), or both types</b>. In addition, for these two same cases, you can do a search without adding any element to the rigth panel and the search will retrieve all systems in the database matching the filters that you have selected (apoform or not, complex structure or dynamics, dynamics settings, etc.). "Dynamics" option allows you to filter the results by some additional features, like the solvent used in the simulation, or the method used to produce it.</p> 

            <p> <b>Note</b>: The difference between molecule and compound is that a compound represents a set of related molecules which only differ in the protonation state or some other subtle feature. As the concept of molecule is more precise, when searching with a molecule, you will only find those systems containing exactly that molecule. However, if you search by its corresponding compound, you will find all the systems which have that exact molecule or any of the other molecules belonging to that compound. So, if you search systems using Clozapine (compound) you will get more results (or the same) than if you search by Clozapine (molecule).</p>
          </div> <!--end of right panel div  -->
          </div>
    </div>
</div> <!--colum -->
</div><!--row-->
</div><!--container-->

<div class="container-fluid">
 <div class="row">
  <div class="col-sm-6">
    <div class="panel panel-info" id="haystacksearch">
      <div class="panel-heading">
            <br> 
            <center><h3>Search for proteins, molecules or compounds.</h3> 
            <form method="post" id="ajaxform" action="." enctype="multipart/form-data">{% csrf_token %}

                <input id="protein22" type="text" class="form-control" name="name" placeholder="5-HT1B receptor"></input>
                <select id="simpletype"><option selected="selected" value="All">All</option><option title="G protein coupled receptor" value="gpcr">GPCR</option><option title="G protein, arrestin, peptide ligand, nanobody, etc." value="protein">Other proteins</option><option title="Molecule in the classical sense, altough different protonation states or different tautomers constitute a molecule on their own. CH3-COOH and CH3COO- wold be two different molecules with its own ID." value="molecule">Molecule</option><option title="Comprises a set of moleculs and it is represented by the standard form of that set. 'Acetic Acid' would join molecules CH3-COOH and CH3COO- and it would be represented by the former" value="compound">Compound</option><option title="System composed by a GPCR and other proteins plus its orthosteric and allosteric ligands" value="complex">Complex (only with ID search)</option><option value="model" title="Entity of Complex and other selected cocrystallized molecules which is used to build the entire solvated and membrane-embeded system">Complex Structure (only with ID search)</option> <option title="Simulations" value="dynamics">Dynamics (only with ID search)</option></select>
<button id="Searcher" type="button" value="Search" class="btn btn-info"> <span class="glyphicon glyphicon-search"> </button>
                <br><input id="idsearch" type="checkbox" value="val">Search by GPCRmd ID
                

            </form> 
            </center>
            <br>
    </div>
      <div class="panel-body" id="haystacksearchbody">
            <table id='ajaxresults22'> <thead><tr><th> Results: </th><th>          </th></tr></thead><tbody><tr><td>No results</td><td>          </td></tr></tbody></table>
            <br><br><br><br><br><br><br><br><br><br><br>
      </div>
    </div>
  </div>



  <div class="col-sm-6">

        <div class="panel panel-info" id="floatdiv">
            <div class="panel-heading" id="lightup"> <center><h3>Search for complexes, complex structures or dynamics</h3></center>
                <center><button id="gotoadvsearch" class="btn btn-info" type="button" value="Advanced Search">Go to Advanced Search</button></center>
            </div>

        <div id='crazycolor' class="panel-body">
        <center>

        <table id="myTable">
        <thead>
        <tr>
            <th>Boolean</th>
            <th>Type</th>
            <th>ID</th>
            <th></th><!--IS RECEPTOR -->
            <th></th><!--name-->
            <th></th><!--REMOVE-->
        </tr>
        </thead>
        <tbody>
        </tbody>
        </table>
        <br>
        <label><input id="exactmatch" type="checkbox" name="exact" value="exactmatch"> Exact Match </label><br><br>
        Return: <select id="result_type"><option selected="selected" value="complex">Complex</option><option value="model">Complex Structure</option><option value="dynamics">Dynamics</option></select>


        <div id='hiddenmodel'>
            <br>
            <label><input type="radio" name="radiosearch" value="apo"> Only apoform </label>
            <label><input type="radio" name="radiosearch" value="com"> Only complexes </label>
            <label><input type="radio" name="radiosearch" value="both" checked="checked" > Both </label>
            <br><br>
        </div>


        <div id='hidden'>
            <br>
            <div id="search_type_dyn">
              <label><input type="radio" name="radiosearch1" value="apo"> Only apoform </label>
              <label><input type="radio" name="radiosearch1" value="com"> Only complexes </label>
              <label><input type="radio" name="radiosearch1" value="both" checked="checked"> Both </label>
            </div>
        <br>
        <table id='dynfil' class='table table-striped'>
        <tbody>
        <tr><td>Time step (smaller than:) </td><td><input id='tstep' type="text" name="tstep"></td></tr>
        <tr><td>Force Field</td><td><select id="fftype"><option selected="selected" value=""> </option><option value="AMBER">AMBER</option><option value="CHARMM">CHARMM</option></select></td></tr>
        <tr><td>Software used</td><td><select id="soft"><option selected="selected" value=""> </option><option value="ACEMD">ACEMD</option><option value="OTHER">OTHER</option></select></td></tr>
        <tr><td>Membrane type</td><td><select id="memtype"><option selected="selected" value=""> </option><option value="1">Implicit</option><option value="2">Homogeneous</option><option value="3">Heterogeneous</option></select></td></tr>
        <tr><td>Method</td><td><select id="method"><option selected="selected" value=""> </option><option value="1">Molecular Mechanics</option><option value="2">QM/MM</option><option value="3">NMR</option><option value="4">Monte Carlo simulation</option><option value="5">MM MSM/HMM adaptive</option><option value="6">MM metadynamics</option><option value="7">MM umbrella sampling</option><option value="8">MM biased</option><option value="9">MM scaled potentials</option></select></td></tr>
        <tr><td>Solvent type</td><td><select id="soltype"><option selected="selected" value=""> </option> <option value="1">Implicit</option><option value="2">TIP3P</option><option value="3">TIP4P</option><option value="4">TIPS</option><option value="5">SPC</option><option value="6">SPC/E</option><option value="7">Other</option></select></td></tr>
        </table>
        <br><br>
        </div>
        <br><br><br><button id="tablesearch" type="button" value="search" class="btn btn-info btn-lg"> <span class="glyphicon glyphicon-search"> </button>
        </center>

    </div> <!--panel body-->

  </div> <!--panel class-->



</div> <!--second col-->
</div><!--container-->
</div>
{% endblock %}

{% block addon_js %}
    <script src="{% static 'dynadb/help_searcher.js' %}"></script>
    <script src="{% static 'dynadb/complex_searcher.js' %}"></script>
    <script src="{% static 'dynadb/autosearch.js' %}"></script>
    <script src="{% static 'dynadb/add_search.js' %}"></script>
    <script src="{% static 'dynadb/ajaxto.js' %}"></script>
    <script src="{% static 'dynadb/tablesearch.js' %}"></script>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script type="text/javascript" src="//jqueryui.com/jquery-wp-content/themes/jquery/js/plugins.js"></script>
    <script type="text/javascript" src="//jqueryui.com/jquery-wp-content/themes/jquery/js/main.js"></script>
    <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.12/js/jquery.dataTables.js"></script>
    <script>
    $.extend( true, $.fn.dataTable.defaults, {
       "searching": false,
       "ordering": false
    } );

    </script>

{% endblock %}
