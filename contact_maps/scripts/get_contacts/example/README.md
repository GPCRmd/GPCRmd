# Examples of how to run different GetContacts scripts and analyses

## Dynamic contacts for the parvalbumin NMR bundle (PDB-id 5XND)

The file `5xnd_trajectory.pdb` was generated by downloading 5xnd from the PDB and running `mdconvert --output 5xnd_trajectory.dcd 5xnd.pdb`. The corresponding topology file contains the first frame of the NMR bundle. To compute the file `5xnd_all-contacts.tsv` with details of all interaction types in the bundle, run the commands
```bash
cd 5xnd/
get_dynamic_contacts.py --topology 5xnd_topology.pdb --trajectory 5xnd_trajectory.dcd --itypes all --output 5xnd_all-contacts.tsv
```


## Static contacts in Crambin (PDB-id 1CRN)

The `get_static_contacts.py` script can be used to generate contacts of a single-model PDB file. Often files downloaded directly from PDB need to have hydrogens added. This can be done in pymol after which the interactions can be computed
```bash
cd 1crn/
pymol -c -d 'fetch 1crn, async=0; h_add; save 1crn_h.pdb'  # Fetch 1CRN and add hydrogens
get_static_contacts.py --structure 1crn_h.pdb --itypes all --output 1crn_all-contacts.tsv
```

## Interaction network comparison of two DHFR simulations

To compare interaction networks of two or more simulations, first generate the contact files for each simulation, convert them to frequency files and finally generate fingerprints. In this example we'll compare hydrophobic interaction networks specifically. Note that some residues are not identical in the two topologies, so to perform the comparison we use a residue-label file to rename residues so they're only identified by their numerical ID.
```bash
cd dhfr/

# Contacts and residue-frequencies for 4M6L trajectory:
get_dynamic_contacts.py --topology dhfr_4m6l_top.psf --trajectory dhfr_4m6l_trj.dcd \
     --itypes hb --sele "protein or resname 21V NAP" --output dhfr_4m6l_hb_contacts.tsv

get_contact_frequencies.py --input_files dhfr_4m6l_hb_contacts.tsv \
     --itypes hbls hblb lwb lwb2 --label_file dhfr_4m6l_labels.tsv \
     --output dhfr_4m6l_freqs.tsv


# Contacts and residue-frequencies for 8DFR trajectory:
get_dynamic_contacts.py --topology dhfr_8dfr_top.psf --trajectory dhfr_8dfr_trj.dcd \
     --itypes hb --sele "protein or resname NDP" --output dhfr_8dfr_hb_contacts.tsv

get_contact_frequencies.py --input_files dhfr_8dfr_hb_contacts.tsv \
     --itypes hbls hblb lwb lwb2 --label_file dhfr_8dfr_labels.tsv \
     --output dhfr_8dfr_freqs.tsv

# Combine them into fingerprints and compare flare files:
get_contact_fingerprints.py --input_frequencies dhfr_{4m6l,8dfr}_freqs.tsv \
     --frequency_cutoff 0.6 --column_headers 4M6L 8DFR \
     --flare_output dhfr_compare.json \
     --plot_output dhfr_compare.png
```



