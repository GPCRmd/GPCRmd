<head>
<script>
    document.domain=document.domain;
</script>
{% extends "covid19/base_covid19.html" %} 
{% load static %} 
{% load covid_custom %}         
{% block addon_css %}
<link rel="stylesheet" type="text/css" href="{% static 'covid19/css/covidhome.css' %}" />
{% endblock %}

  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css">
  <base href="your_domain/" target="_PARENT">

</head>

{% block content %} 
<body style="padding:0">


<div class="row" style="padding:70px 0;background-color: #3AAFD2;color:white">
  <div style="width:90%;margin:auto">
    <div>
      <div style="float:left">
        <center>    
            <img src="{% static 'covid19/images/scov2-md_sq_white.png' %}" id="biglogo" class="img-responsive" style="width:150px;margin-right:30px">
        </center>
      </div>
      <div style="float:left;">
        <div style="margin-top:20px">
          <h1 style="font-weight:bold;font-size:70px">SCoV2-MD</h1>
          <h2 style="color:#f1faee;font-weight:bold;font-size:20px">Share, visualize and analyze MD data of SARS-CoV-2 related proteins.</h2>    
        </div>
      </div>
    </div>
    <div class="input_search_cont" >
      <input class="input_search" type="text" name="search" placeholder="Search for a protein (e.g. Spike, NSP3, ...)">
      <button type="button" class="btn btn-default btn_input btn_input_search">
        <span class="glyphicon glyphicon-search "></span> 
      </button>
    </div>
  </div>
</div>



<div > 
  <div class="row">
    <div style="width:90%;margin:40px auto;overflow:auto;">

      <div id="covid_image" class="col-md-7"> 

          <div style="margin-bottom: 20px;text-align:center">
              <p class="section_title" style="margin-bottom:30px;color:#fe696a;">Click on a protein to find MD simulations</p><p style="font-size:17px">Here you can find simulations of multiple SARS-CoV-2 proteins. Click on one viral protein to browse them.</p>          
            </div>


        <!-- Image Map Generated by http://www.image-map.net/ -->
        <img class="h_center_img" src="{% static 'covid19/images/coronavirus.jpg' %}" usemap="#image-map" height="500px">

          <map name="image-map">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'n'}}" alt="nucleocapsid" href="/covid19/prot/N" coords="104,305,4,322" shape="rect">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'spike'}}" alt="spike" href="/covid19/prot/Spike" coords="327,464,448,484" shape="rect">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'orf7a'}}" alt="orf7a" href="/covid19/prot/ORF7a" coords="552,156,488,104" shape="rect">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp1'}}" alt="nsp1" href="/covid19/prot/NSP1" coords="592,206,619,156,646,152,661,186,649,210,616,219,605,212" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'e'}}" alt="envelope_prot" href="/covid19/prot/E" coords="156,68,50,45" shape="rect">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'membrane_prot'}}" alt="membrane_prot" href="/covid19/prot/M" coords="332,45,451,65" shape="rect">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp3'}}" alt="nsp3" href="/covid19/prot/NSP3" coords="696,169,714,152,754,165,752,218,702,205" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp5'}}" alt="nsp5" href="/covid19/prot/NSP5" coords="779,192,804,164,829,157,851,162,860,192,847,204,799,215" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp8'}}" alt="nsp8" href="/covid19/prot/NSP8" coords="622,270,635,265,649,255,659,229,638,231,624,242,620,257" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp7'}}" alt="nsp7" href="/covid19/prot/NSP7" coords="619,275,634,268,649,282,649,294,633,306,609,296,608,284" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp12'}}" alt="nsp12" href="/covid19/prot/NSP12" coords="637,268,651,255,665,232,681,240,703,234,716,254,705,284,670,318,633,310,656,292" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp9'}}" alt="nsp9" href="/covid19/prot/NSP9" coords="768,239,814,229,823,256,808,291,756,292,745,262,758,249" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp10'}}" alt="nsp10" href="/covid19/prot/NSP10" coords="703,316,735,301,776,302,772,352,735,367,710,353" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp13'}}" alt="nsp13" href="/covid19/prot/NSP13" coords="579,388,611,363,618,345,660,349,687,371,642,433,596,408" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp15'}}" alt="nsp15" href="/covid19/prot/NSP15" coords="805,354,799,333,820,323,840,338,851,381,792,413,773,369" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp16'}}" alt="nsp16" href="/covid19/prot/NSP16" coords="703,388,722,403,722,433,736,437,734,458,710,466,676,447,675,421" shape="poly">
              <area class="tooltip_imageclickable" target="" data-toggle="tooltip"  title="{{finprot|create_finprot_tooltip_data:'nsp10'}}" alt="nsp10-2" href="/covid19/prot/NSP10" coords="724,402,734,398,737,385,759,392,753,409,794,441,757,440,745,448,741,437,726,428" shape="poly">
          </map>
       </div>

      <div class="col-md-5">
        <div style="height:617px;position:relative;margin-top:150px;width:500px;margin-right:auto;margin-left:auto">
          <center>
            <div style="width: 100%;text-align:left;z-index: 10;position:relative;">
              <p style="color:#5900ff;margin-bottom:0">Alpha (B.1.1.7)</p>
              <p style="color:#00ff19;margin-bottom:0">Beta (B.1.351)</p>
              <p style="color:#ff7200;margin-bottom:0">Gamma (P.1)</p>
              <p style="color:#00ebff;margin-bottom:0">Delta (B.1.617.2)</p>
              <p style="color:#ff0000;margin-bottom:0">Omicron (B.1.1.529)</p>
            </div>
            <iframe style="border: 0px none;width: 500px;position:absolute;top:0px;left:0px;" id="embed_mdsrv" src="{{mdsrv_url}}/html/embed_covid_home.html" scrolling="no" height="500px" width="590px" ></iframe>
          </center>
          <!--<div style="margin: 0px;position: absolute;top: 50%;-ms-transform: translateY(-50%);transform: translateY(-50%);">
              <p class="section_title" style="margin-bottom:30px;color:#fe696a;">Click on a protein to find MD simulations</p><p style="font-size:17px">Here you can find simulations of multiple SARS-CoV-2 proteins. Click on one viral protein to browse them.</p>          
            </div>-->
          </div>
        </div>

       
     </div>
   </div>
   <div id="covid_var_plot" style=""> 
      <div class="row" style="background-color: #dbebf0" >
        <div style="width:90%;margin:60px auto;">
          <p class="section_title">Virus evolution</p>
          <p style="font-size:17px">Phylogenetic tree of genomes sampled between {{sequenced_from}} and {{sequenced_to}}. Click on one genome to see the details and map the corresponding mutations on a structure.</p> 
        </div>
      </div>
      <span id="loading"><center ><img src="{% static 'covid19/images/loading-gear.gif' %}" style="width:50px;height:50px;margin-top:210px;position:absolute;z-index:10;margin-left:-25px"/></center></span>
      <div style="padding:40px 20px">
        <div id="opton_titles_row" class="hiddenwhenload">
          <div id="legend_title" style="float:left;margin-top:7px;width:200px">
            <p style="font-weight:bold;margin:0">
              <span class="trigger_collapse"  data-target="#legend_data"><span class="glyphicon glyphicon-plus-sign"></span> Legend</span>
            </p>
          </div>
          <div class="hiddenwhenload" style="margin: 0 10px; display: inline;float:left;">
              <div class="phyltree_option">
              Color by
                <select id="colorby" name="colorby"  class="form-control" style="padding:4px 10px">
                  {% for myvar in var_li %}
                    {% if myvar.0 == "region" %}
                      <option value="{{myvar.0}}" selected="selected">{{myvar.1}}</option>
                    {% elif myvar.0 != "date_list" %}
                      <option value="{{myvar.0}}" >{{myvar.1}}</option>
                    {% endif %}
                   {% endfor %}
                </select>
                </div>
                <div class="phyltree_option" >
                  Filter by
                  <span class="glyphicon glyphicon-info-sign hovertexttooltip" data-toggle="tooltip"   title="<div class='leftalign'><p>Use this box to filter the displayed data.</p> <p>For instance, start typing a country's name to filter the data accordingly.</p><p>Data is filtered by forming a union of selected values within each category, and then taking the intersection between categories (if more than one category is selected).</p></div>"></span>
                  <select  id="phyltree_filter" class="selectpicker"  multiple data-live-search="true"  data-selected-text-format="count" data-size="10">
                    {% for param_id, param_data in colors_dict_selectopt|sort_dict_by_key %}
                      <optgroup label="{{param_data.name}}">
                        {% for opt in param_data.options %}
                          <option value="{{param_id}}__{{opt}}" >{{param_data.name}}: {{opt}}</option>
                        {% endfor %}
                      </optgroup>
                    {% endfor %}
                  </select>
                  <button class="btn btn-link selectpicker_clear remove_icon_btn" data-target="#phyltree_filter"  ><span class="glyphicon glyphicon-remove-circle"></span></button>
                </div>

              <button title="" style="display:none;padding: 5px 10px;font-size:14px;height:35px;" class="btn btn-default btn-xs phyltree_option" id="showWholeTree">Restart</button>
          </div>
        </div>

        <div id="data_row" style="clear:both">
          <span id="legend_popup"></span>
          <div id="additional_info_cont">
          </div>
          <div id="legend_data" style="margin-top: 14px;clear:left;float:left">
            <div  style="overflow:auto;max-height:500px;border-left:1px solid lightgrey;margin-left:5px;width:200px">
              <div id="legend_cont" class="hiddenwhenload"></div>
            </div>
          </div>
          <div  >
            <div class="scrolltop_wrapper1">
                <div class="scrolltop_div1">
                </div>
            </div>
            <div class="scrolltop_wrapper2" style="overflow:auto;">
              <div id="chart"  class="scrolltop_div2" data-simulated_prots="{{simulated_prots}}" data-genome_mutations="{{genome_mutations}}" data-tree_data="{{tree_data}}" data-colors_dict="{{colors_dict}}">
              </div>
            </div>
          </div>
        </div>
    </div>
    <div style="background-color: #dbebf0;padding:40px 20px">
      <p> Data obtained from <a href="https://www.gisaid.org/epiflu-applications/phylodynamics/">GISAID.</a></p>
      <ul style="list-style-type: none;">
        <li><a href="https://doi.org/10.1093/bioinformatics/bty407">Hadfield et al, Nextstrain: real-time tracking of pathogen evolution, Bioinformatics (2018)</a></li>
        <li><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5758920/">Sagulenko et al, TreeTime: Maximum-likelihood phylodynamic analysis, Virus Evolution (2017)</a></li>
      </ul>
    </div>
  </div>

</div>


{% endblock content %}
{% block addon_js %} 

<!-- From base.html -->
    <!-- Change JQueryUI plugin names to fix name collision with Bootstrap.-->
    <script>
    $.widget.bridge('uitooltip', $.ui.tooltip);
    $.widget.bridge('uibutton', $.ui.button);
    </script>
    <script src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>

<!-- END From base.html -->
<script src="https://d3js.org/d3.v4.js"></script>
<script  src="{% static 'covid19/js/covidhome.js' %}"></script>



<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css">
<!--<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/plug-ins/1.10.20/features/pageResize/dataTables.pageResize.min.js">-->
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>

<!--<script  src="{% static 'covid19/js/upload.js' %}"></script>-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.8.1/css/bootstrap-select.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.8.1/js/bootstrap-select.js"></script>
<!-- End Bootstrap select -->


{% endblock %}
</body>