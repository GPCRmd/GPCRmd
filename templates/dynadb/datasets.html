<head>
    <script>
        document.domain = document.domain;
    </script>
    {% extends "home/base.html" %}
    {% load static %}
    {% block addon_css %}
    {% endblock %}

</head>

<body>
    {% block content %}

    {% autoescape off %}
    <div class="row datasetDiv" style="display: grid;place-items: center;place-content: center;grid-auto-flow: column;align-content: center;">        <!-- Left panel: GPCRmd dataset -->
        <div class="twoPanel">
            <div id="gpcrmd_set" class="panel panel-primary ">
                <h2 class="panel-heading">GPCRmd dataset</h2>
                <div class="panel-body">
                    <p class="orangeSub">MD simulation data generated by the GPCRmd community</p>

                    {% for class_data in gpcrclassif %}
                    {% if class_data.has_sim %}
                    <div class="avail class_nm element_nm" data-toggle="collapse"
                        data-target="#fam_elements_{{class_data.slug}}">{{ class_data.name }}</div>
                    <div id="fam_elements_{{class_data.slug}}" class="collapse list_cont">
                        {% for fam_data in class_data.children %}
                        {% if fam_data.has_sim %}
                        <div class="avail fam_nm element_nm" data-toggle="collapse"
                            data-target="#stype_elements_{{fam_data.slug}}">{{ fam_data.name }}</div>
                        <div id="stype_elements_{{fam_data.slug}}" class="collapse list_cont">
                            {% for stype_data in fam_data.children %}
                            {% if stype_data.has_sim %}
                            <div class="avail stype_nm element_nm" data-toggle="collapse"
                                data-target="#prot_elements_{{stype_data.slug}}">{{ stype_data.name }}</div>
                            <div id="prot_elements_{{stype_data.slug}}" class="collapse list_cont">
                                {% for prot_data in stype_data.children %}
                                {% if prot_data.has_sim %}
                                <div class="prot_nm element_nm avail" data-toggle="collapse"
                                    data-target="#dyn_elements_{{prot_data.slug}}">{{ prot_data.name }}</div>
                                <div s id="dyn_elements_{{prot_data.slug}}" class="collapse list_cont">
                                    {% for pdbid,pdbdynli in prot_data.children.items %}
                                    <div class="pdb_nm element_nm">
                                        {{pdbid}}
                                    </div>
                                    <div class="list_cont">
                                        {% for dyn_id,mymodelname in pdbdynli %}
                                        <div class="dyn_nm element_nm">{{mymodelname}} (<a class="textlink"
                                                href="/view/{{dyn_id}}/">ID
                                                {{dyn_id}}</a>)</div>
                                        {% endfor %}
                                    </div>
                                    {% endfor %}
                                </div>
                                {% else %}
                                <div class="prot_nm element_nm not_avail">{{ prot_data.name }}</div>
                                {% endif %}
                                {% endfor %}
                            </div>
                            {% else %}
                            <div class="stype_nm element_nm not_avail">{{ stype_data.name }}</div>
                            {% endif %}
                            {% endfor %}
                        </div>
                        {% else %}
                        <div class="not_avail fam_nm element_nm">{{ fam_data.name }}</div>
                        {% endif %}
                        {% endfor %}
                    </div>
                    {% else %}
                    <div class="not_avail class_nm element_nm">{{ class_data.name }}</div>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>

        </div>

        <div class="col-sm-2 twoPanel" style="width: 600px;">
            {% comment %} <h4 class="extrainfo_title">Contribution in GPCRmd</h4> {% endcomment %}
            <div style="overflow-x: auto;overflow-y: hidden;display: grid;place-items: center">
                <div id="stats_dataset" style="position: absolute" data-stats_dataset='{{stats_dataset}}'>
                </div>
                <div class="centerLabel" style="left: 0px;">{{total_stats_dataset}}</div>
            </div>
        </div>

        <!-- Right panel: contributors dataset -->
        <div class="twoPanel">
            <div id="external_set" class="panel panel-primary" style="border-color: #b4aca9;">
                <h2 class="panel-heading" style="background-color: #b4aca9;">Individual contributions</h2>

                <div class="panel-body">
                    <p class="orangeSub">MD simulation data generated by individual contributors</p>

                    {% for class_data in others_gpcrclassif %}
                    {% if class_data.has_sim %}
                    <div class="avail class_nm element_nm" data-toggle="collapse"
                        data-target="#o_fam_elements_{{class_data.slug}}">{{ class_data.name }}</div>
                    <div id="o_fam_elements_{{class_data.slug}}" class="collapse list_cont">
                        {% for fam_data in class_data.children %}
                        {% if fam_data.has_sim %}
                        <div class="avail fam_nm element_nm" data-toggle="collapse"
                            data-target="#o_stype_elements_{{fam_data.slug}}">{{ fam_data.name }}</div>
                        <div id="o_stype_elements_{{fam_data.slug}}" class="collapse list_cont">
                            {% for stype_data in fam_data.children %}
                            {% if stype_data.has_sim %}
                            <div class="avail stype_nm element_nm" data-toggle="collapse"
                                data-target="#o_prot_elements_{{stype_data.slug}}">{{ stype_data.name }}</div>
                            <div id="o_prot_elements_{{stype_data.slug}}" class="collapse list_cont">
                                {% for prot_data in stype_data.children %}
                                {% if prot_data.has_sim %}
                                <div class="prot_nm element_nm avail" data-toggle="collapse"
                                    data-target="#o_dyn_elements_{{prot_data.slug}}">{{ prot_data.name }}</div>
                                <div s id="o_dyn_elements_{{prot_data.slug}}" class="collapse list_cont">
                                    {% for pdbid,pdbdynli in prot_data.children.items %}
                                    <div class="pdb_nm element_nm">
                                        {{pdbid}}
                                    </div>
                                    <div class="list_cont">
                                        {% for dyn_id,mymodelname,author in pdbdynli %}
                                        <div class="dyn_nm element_nm">{{mymodelname}} (<a class="textlink"
                                                href="/view/{{dyn_id}}/">ID
                                                {{dyn_id}}</a>) - {{author}}</div>
                                        {% endfor %}
                                    </div>
                                    {% endfor %}
                                </div>
                                {% else %}
                                <div class="prot_nm element_nm not_avail">{{ prot_data.name }}</div>
                                {% endif %}
                                {% endfor %}
                            </div>
                            {% else %}
                            <div class="stype_nm element_nm not_avail">{{ stype_data.name }}</div>
                            {% endif %}
                            {% endfor %}
                        </div>
                        {% else %}
                        <div class="not_avail fam_nm element_nm">{{ fam_data.name }}</div>
                        {% endif %}
                        {% endfor %}
                    </div>
                    {% else %}
                    <div class="not_avail class_nm element_nm">{{ class_data.name }}</div>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    {% endautoescape %}

    {% endblock content %}
    {% block addon_js %}
    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>

    <script>
        //-------------------------- Stats chart
      function drawChart_datasetstats() {

         var data_all = $("#stats_dataset").data("stats_dataset");
         var data = google.visualization.arrayToDataTable(data_all);
         var options = {
            slices: {
            0: { color: '#D96B52' },
            1: { color: '#837d7b' }
            },
            pieHole: 0.4,
            chartArea: { width:500, height:200},
            pieSliceTextStyle:{
            color:"white", 
            fontSize:12,
            position: 'start',
            },
            width:400,
            height:400,
            legend:{ alignment:"center", position:'none', textStyle: {fontSize: 12}},
            pieSliceText: 'none',
            sliceVisibilityThreshold: 0,             
            legend: 'labeled',
        };

         var chart = new google.visualization.PieChart(document.getElementById('stats_dataset'));

         chart.draw(data, options);
       }
       google.load("visualization", "1.0", {packages:["corechart"],'callback': drawChart_datasetstats});

    </script>
    {% endblock %}
</body>